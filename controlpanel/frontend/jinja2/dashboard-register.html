{% from "error-message/macro.html" import govukErrorMessage %}
{% from "autocomplete/macro.html" import autocomplete %}


{% extends "base.html" %}

{% set page_title = "Share a dashboard" %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    <h1 class="govuk-heading-xl">{{ page_title }}</h1>

    <form method="post" action="{{ url("register-dashboard") }}">
      {{ csrf_input }}

      {% set error_qs_msg = form.errors.get("quicksight_id") %}
      {% call(dashboard) autocomplete({
        "name": "quicksight_id",
        "label": {"text": "Choose dashboard", "classes": "govuk-label--s"},
        "hint": {"text": "Start typing the name of your dashboard as it appears in QuickSight."},
        "items": dashboards,
        "required": True,
        "formGroup": {"classes": "autocomplete--full-width"},
        "errorMessage": {"html": error_qs_msg|join(". ")} if error_qs_msg else None,
      }) %}
        <option value="{{ dashboard.DashboardId }}">{{ dashboard.Name }}</option>
      {% endcall %}
      <div class="govuk-form-group" id="container-element">

        <label class="govuk-label govuk-label--s" for="description">Enter a description
        </label>
        <div id="description-hint" class="govuk-hint">
          Help people understand what your dashboard shows. Explain any acronyms or less common terms.
        </div>

        {% set error_qsid_msg = form.errors.get("description") %}
        {% if error_qsid_msg %}
          {% set errorId = 'qsid-error' %}
          {{ govukErrorMessage({
            "id": errorId,
            "html": error_qsid_msg|join(". "),
          }) }}
        {% endif %}

        <textarea type="text" class="govuk-textarea" id="description" name="description" rows="5" aria-describedby="description-hint" {% if form.description.value() %} value="{{ form.description.value() }}" {% endif %}></textarea>

      </div>


      <div class="govuk-form-group">
        <button class="govuk-button">Register dashboard</button>
      </div>
    </form>
  </div>
</div>
{% endblock %}
