{% from "radios/macro.html" import govukRadios %}

{% extends "base.html" %}

{% set page_title = "Edit data access level" %}

{% block content %}
<h1 class="govuk-heading-xl">{{ page_title }}</h1>

<section class="cpanel-section">
  <form method="post" action="{{ url('update-access-level', kwargs={ "pk": object.id }) }}">
    {{ csrf_input }}
    <input type="hidden" name="user_id" value="{{ object.user.id }}">
    {{ govukRadios({
      "name": "access_level",
      "fieldset": {
        "legend": {
          "text": "Data access level",
          "classes": "govuk-fieldset__legend--m",
        },
      },
      "hint": {
        "html": "<strong>NOTE:</strong> Making a user an admin will allow them to confer access rights on additional users.",
      },
      "items": [
        {
          "value": "readonly",
          "text": "Read only",
          "checked": not object.is_admin and object.access_level == "readonly"
        },
        {
          "value": "readwrite",
          "text": "Read/write",
          "checked": not object.is_admin and object.access_level == "readwrite"
        },
        {
          "value": "admin",
          "text": "Admin",
          "checked": object.is_admin,
        }
      ]
    }) }}
    <button class="govuk-button">Save</button>
  </form>
</section>

{% if request.user.is_superuser %}
<section class="cpanel-section">
  <form method="post" action="{{ url('revoke-datasource-access', kwargs={"pk": object.id}) }}">
    {{ csrf_input }}
    <button class="govuk-button cpanel-button--destructive">Revoke access</button>
  </form>
</section>
{% endif %}
{% endblock %}
